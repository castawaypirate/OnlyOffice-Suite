<div class="file-list-container">
  <div class="header">
    <div class="title-section">
      <h2>My Documents</h2>
      <p *ngIf="currentUser$ | async as user" class="welcome-text">
        Welcome, {{ user.username }}!
      </p>
    </div>
    <button class="logout-btn" (click)="onLogout()">Logout</button>
  </div>
  
  <div class="upload-section">
    <input 
      type="file" 
      #fileInput 
      (change)="onFileSelected($event)" 
      style="display: none;"
      accept=".doc,.docx,.xls,.xlsx,.ppt,.pptx,.pdf,.txt">
    <button 
      class="upload-btn" 
      (click)="fileInput.click()"
      [disabled]="isLoading">
      📁 {{ isLoading ? 'Uploading...' : 'Upload Document' }}
    </button>
  </div>

  <div *ngIf="errorMessage" class="error-message">
    {{ errorMessage }}
  </div>

  <div class="files-table">
    <table>
      <thead>
        <tr>
          <th>File Name</th>
          <th>Status</th>
          <th>Upload Date</th>
          <th>Size</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let file of files" [class.temp-file]="file.isTemporary">
          <td>{{ file.name }}</td>
          <td>
            <span *ngIf="file.isTemporary" class="status-badge temp">📋 Temporary</span>
            <span *ngIf="!file.isTemporary" class="status-badge saved">✅ Saved</span>
          </td>
          <td>{{ file.uploadDate | date:'short' }}</td>
          <td>{{ file.size }}</td>
          <td class="actions">
            <!-- Buttons for temporary files -->
            <ng-container *ngIf="file.isTemporary">
              <button
                class="save-btn"
                (click)="saveFile(file)"
                [disabled]="isLoading"
                title="Save file permanently">
                💾 Save
              </button>
              <button
                class="delete-btn"
                (click)="deleteFile(file)"
                title="Delete temporary file">
                🗑️ Delete
              </button>
            </ng-container>

            <!-- Buttons for saved files -->
            <ng-container *ngIf="!file.isTemporary">
              <button
                class="download-btn"
                (click)="downloadFile(file)"
                title="Download file">
                ⬇️ Download
              </button>
              <button
                *ngIf="onlyOfficeEnabled"
                class="open-btn"
                (click)="openDocument(file.id)"
                title="Open in editor">
                📝 Edit
              </button>
              <button
                class="delete-btn"
                (click)="deleteFile(file)"
                title="Delete file">
                🗑️ Delete
              </button>
            </ng-container>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div *ngIf="files.length === 0 && !isLoading" class="no-files">
    <p>No documents uploaded yet. Upload your first document to get started!</p>
  </div>

  <div *ngIf="isLoading" class="loading">
    <p>Loading...</p>
  </div>

  <!-- Success modal -->
  <div *ngIf="showSuccessModal" class="modal-overlay" (click)="closeSuccessModal()">
    <div class="modal-content success" (click)="$event.stopPropagation()">
      <div class="modal-icon">✅</div>
      <h3>Success</h3>
      <p>{{ successMessage }}</p>
      <button class="modal-btn" (click)="closeSuccessModal()">OK</button>
    </div>
  </div>
</div>